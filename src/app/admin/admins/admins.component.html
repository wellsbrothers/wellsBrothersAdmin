<section class="row w-100 no-margin">
  <div class="col-12 no-padding">
    <div class="row pt-5 pb-5 no-margin">
      <div class="col-6">
        <h1 class="h2">Dispatchers</h1>
      </div>
      <div class="col-6 text-right">
        <button class="btn btn-primary" [routerLink]="['./add-admin']">Add Dispatcher</button>
      </div>
      <div class="col-12">
        <hr>
      </div>
    </div>
  </div>
  <div class="col-12">
    <div class="card">
      <div class="row no-margin p-3">
        <div class="col-3">
          <div class="form-group">
            <label for="name">Name</label>
            <input type="text" class="form-control" name="name" id="name" [(ngModel)]="search.fullName" (keyup)="getAdmins(); page = 1">
          </div>
        </div>
        <div class="col-3">
          <div class="form-group">
            <label for="username">User Name</label>
            <input type="text" class="form-control" name="username" id="username" [(ngModel)]="search.username" (keyup)="getAdmins(); page = 1">
          </div>
        </div>
        <div class="col-3">
          <div class="form-group">
            <label for="role">Role</label>
            <select class="form-control" name="role" id="role" [(ngModel)]="search.role" (change)="getAdmins(); page = 1">
              <option value="" selected>All</option>
              <option value="0">Admin</option>
              <option value="1">Manager</option>
              <option value="2">Agent</option>
            </select>
          </div>
        </div>
        <div  class="col-3">
          <div class="form-group">
            <label for="phone3">Phone</label>
            <input type="text" class="form-control" name="phone" id="phone3" [(ngModel)]="search.phone" (keyup)="getAdmins(); page = 1">
          </div>
        </div>
      </div>
    </div>
    <hr>
    <div class="card">
      <div class="card-body">
        <div class="row w-100">
          <div class="col-12">
            <div class="row p-2">
              <div class="col-2">
                <select name="" class="form-control"  (change)="getAdmins(); this.page = 1" [(ngModel)]="limit">
                  <option value="20">20</option>
                  <option value="30">30</option>
                  <option value="50">50</option>
                  <option value="100">100</option>
                </select>
              </div>
              <div class="col-10 text-right">
              </div>
            </div>
          </div>
          <div class="col-12 table-responsive">
            <table class="table" *ngIf="admins">
              <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">Name</th>
                <th scope="col">Username</th>
                <th scope="col">Phone</th>
                <th scope="col">Status</th>
                <th scope="col">Show TrackBorder</th>
                <th scope="col">Edit</th>
              </tr>
              </thead>
              <tbody>
              <tr *ngFor="let admin of admins; let i = index">
                <th scope="row">{{page * i + 1}}</th>
                <td>{{admin.fullName}}</td>
                <td>{{admin.username}}</td>
                <td>{{admin.phone}}</td>
                <td>
                  <div class="custom-control custom-switch">
                    <input type="checkbox" class="custom-control-input" id="customSwitch{{page*i}}" [(ngModel)]="admin.status" (ngModelChange)="changeStatus(admin)">
                    <label class="custom-control-label" for="customSwitch{{page*i}}"></label>
                  </div>
                </td>
                <td>
                  <div class="custom-control custom-switch">
                    <input type="checkbox" class="custom-control-input" id="switch{{page*i}}" [(ngModel)]="admin.showTrackBoard" (ngModelChange)="updateshowTrackBoard(admin)">
                    <label class="custom-control-label" for="switch{{page*i}}"></label>
                  </div>
                </td>
                <td>
                  <button class="btn btn-primary" [routerLink]="['./edit-admin', admin._id]">
                    <i class="fas fa-pencil-alt"></i>
                  </button>
                </td>
              </tr>
              </tbody>
            </table>
          </div>
          <div class="col-12">
            <div class="row">
              <div class="col-2">
                <select name="" class="form-control"  (change)="getAdmins(); this.page = 1" [(ngModel)]="limit">
                  <option value="20">20</option>
                  <option value="30">30</option>
                  <option value="50">50</option>
                  <option value="100">100</option>
                </select>
              </div>
              <div class="col-10">
                <div class="row no-margin justify-content-end"  *ngIf="total > limit">
                  <app-pagination
                    [count]="total"
                    [page]="page"
                    [perPage]="limit"
                    [pagesToShow]="5"
                    (goPrev)="prev()"
                    (goNext)="next()"
                    (goPage)="currentpage($event)">
                  </app-pagination>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
